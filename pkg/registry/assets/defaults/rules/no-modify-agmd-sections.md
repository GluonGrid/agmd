---
name: no-modify-agmd-sections
category: agmd
description: Protect agmd-managed sections from modification
---

# Rule: Preserve agmd-Managed Sections

**IMPORTANT:** When working with `AGENTS.md` files managed by agmd:

## Understanding the Markers

The AGENTS.md file contains two types of sections, marked with HTML comments:

### Managed Section (Auto-Generated)
```markdown
<!-- agmd:managed-start -->
<!-- Auto-generated by agmd. Do not edit manually. -->

[Rules, workflows, and guidelines go here]

<!-- agmd:managed-end -->
```

### Custom Section (User-Editable)
```markdown
<!-- agmd:custom-start -->

## Your Custom Content

Add project-specific notes, instructions, or any custom content here.
This section is preserved when agmd regenerates AGENTS.md.

<!-- agmd:custom-end -->
```

## What You MAY Do

✅ **You CAN:**
- Edit, add, or remove anything between `<!-- agmd:custom-start -->` and `<!-- agmd:custom-end -->`
- Add sections, subsections, code blocks, lists, etc. in the custom section
- Add project-specific instructions, notes, or documentation
- Format the custom section however you like

## What You MUST NOT Do

❌ **You MUST NOT:**
- Modify content between `<!-- agmd:managed-start -->` and `<!-- agmd:managed-end -->`
- Remove or change the marker comments themselves (`<!-- agmd:... -->`)
- Add content outside of the marked sections

## Why This Matters

**Managed sections are auto-generated** by the `agmd` CLI tool from:
- The source file `directives.md` in the project
- Rules, workflows, and guidelines from the registry (`~/.agmd/`)
- Active items expanded via `@rule:name` or `:::new` markers

Any manual changes to managed sections will be **overwritten** when:
- `agmd generate` is run to regenerate AGENTS.md from directives.md
- Rules/workflows are updated in the registry

## How to Make Changes

### To Modify Rules/Workflows/Guidelines

Edit `directives.md` instead of editing AGENTS.md directly:

```bash
# Edit directives.md to add @rule:name references or :::new markers
# Then regenerate AGENTS.md
agmd generate

# Or create a new custom rule in the registry
agmd new rule my-rule

# Then add it to directives.md
agmd add rule my-rule
```

### To Add Project-Specific Content

Edit the custom section in AGENTS.md directly:

```markdown
<!-- agmd:custom-start -->

## Project Setup

### Prerequisites
- Node.js 18+
- pnpm installed

### Environment Variables
- `DATABASE_URL` - PostgreSQL connection string
- `API_KEY` - Third-party API key

## Common Issues

### Build Fails
Check that all dependencies are installed: `pnpm install`

<!-- agmd:custom-end -->
```

## Example AGENTS.md Structure

```markdown
# Agent Instructions

<!-- agmd:managed-start -->
<!-- Auto-generated by agmd. Do not edit manually. -->

## Rules

### no-modify-agmd-sections
[This rule's content]

### typescript
[TypeScript rules]

## Workflows

### release
[Release workflow steps]

<!-- agmd:managed-end -->

<!-- agmd:custom-start -->

## Project-Specific Notes

Add your custom content here.

<!-- agmd:custom-end -->
```

---

**Remember:** Respect the markers, use the CLI for managed content, and you're free to customize the custom section!
